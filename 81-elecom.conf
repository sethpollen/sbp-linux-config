# Xorg configuration for Elecom M-HT1UR trackball mouse.
#
# To install, copy this file to /usr/share/X11/xorg.conf.d/
#
# Links for understanding this file:
#   https://linux.die.net/man/5/xorg.conf
#   https://www.mankier.com/4/libinput

# Quick reference. This file is responsible for button mappings; my i3 config
# is responsible for converting some of the buttons into keystrokes.
#
#                           _________       _____    _____
#                          /         \     |     |  |     |
#            _______      /           \    |     |  |     |
#           |       |    /   mouse     \   |     |  |right|
#           |  [+]  |    \   pointer   /   | [e] |  |click|
#           |_______|     \           /    |     |  |     |
#           |       |      \_________/     |     |  |     |
#           |  [-]  |                      |_____|  |_____|
#           |_______|
#
#
#     ________                    ________
#    /        |                  |        \
#   |         |                  |  left   |
#   |        _|        ___       |_ click  |
#   |       |         /   \        |       |
#   | scroll|        | [s] |       |_______|
#   |       |        |     |       |       |
#   |       |_        \___/       _|       |
#   |         |                  |  middle |
#   |         |                  |  click  |
#    \________|                  |________/
#
# It would be nice to also be able to map the wheel rotation and side clicks to
# keystrokes, but the driver generates the same button events for those actions
# as for scrolling with the ball.
#
# TODO: Maybe we can still use the side clicks on the wheel to do j/k or +/-?

# Tell Xorg that we are going to talk about input devices.
Section "InputClass"
  # A unique name for this device.
  Identifier "Elecom Trackball"

  # Only apply these settings to pointing devices that claim to be Logitech
  # Trackballs.
  MatchProduct "ELECOM TrackBall Mouse HUGE"
  MatchIsPointer "on"

  # Use libinput.
  MatchDevicePath "/dev/input/event*"
  Driver "libinput"

  # I don't know what this does. I cargo-culted it from someone else.
  Option "SendCoreEvents" "true"

  # Elecom maps clicks to slots in this array as follows:
  #
  #                                   1  2  3  4  5  6  7  8  9  10  11  12
  #                                   |  |  |  |  |  |  |  |  |  |   |   |
  #     "L" thumb button -------------+  |  |  |  |  |  |  |  |  |   |   |
  #                                      |  |  |  |  |  |  |  |  |   |   |
  #     clicking the wheel --------------+  |  |  |  |  |  |  |  |   |   |
  #                                         |  |  |  |  |  |  |  |   |   |
  #     "R" finger button ------------------+  |  |  |  |  |  |  |   |   |
  #                                            |  |  |  |  |  |  |   |   |
  #     spin wheel away from you --------------+  |  |  |  |  |  |   |   |
  #                                               |  |  |  |  |  |   |   |
  #     spin wheel towards you -------------------+  |  |  |  |  |   |   |
  #                                                  |  |  |  |  |   |   |
  #     push wheel down -----------------------------+  |  |  |  |   |   |
  #                                                     |  |  |  |   |   |
  #     push wheel up ----------------------------------+  |  |  |   |   |
  #                                                        |  |  |   |   |
  #     right arrow thumb button --------------------------+  |  |   |   |
  #                                                           |  |   |   |
  #     left arrow thumb button ------------------------------+  |   |   |
  #                                                              |   |   |
  #     "Fn1" button --------------------------------------------+   |   |
  #                                                                  |   |
  #     "Fn2" button ------------------------------------------------+   |
  #                                                                      |
  #     "Fn3" button ----------------------------------------------------+
  #
  # I remap this space onto my own set of actions. In some cases I have the
  # driver send high-order button presses (button20+), which I then remap onto
  # keystrokes in my i3 config.
  #
  #    "L" thumb button            -> nothing (used below for scroll)
  #    clicking the wheel          -> nothing (too hard for me to press)
  #    "R" finger button           -> button20
  #    spin wheel away from you    -> button21
  #    spin wheel away towards you -> button22
  #    push wheel down             -> middle click (button2)
  #    push wheel up               -> nothing (too hard for me to press)
  #    right arrow thumb button    -> nothing (used below for scroll)
  #    left arrow thumb button     -> right click (button3)
  #    "Fn1" button                -> button23
  #    "Fn2" button                -> button24
  #    "Fn3" button                -> button25
  #
  Option "ButtonMapping" "1 0 20 21 22 2 0 0 3 23 24 25"

  # Enable scrolling mode by pressing the right arrow thumb button.
  Option "ScrollMethod" "button"
  Option "ScrollButton" "8"

  # I like low sensitivity (for fine adjustments) with high acceleration (for
  # fast movements).
  Option "AccelSpeed" "1"
EndSection

