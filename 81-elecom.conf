# Xorg configuration for Elecom M-HT1UR trackball mouse.
#
# To install, copy this file to /usr/share/X11/xorg.conf.d/
#
# Links for understanding this file:
#   https://linux.die.net/man/5/xorg.conf
#   https://www.mankier.com/4/libinput

# Quick reference. This file is responsible for button mappings; my i3 config
# is responsible for converting some of the buttons into keystrokes.
#
# Each button's physical number is given in parentheses; the ButtonMapping
# below maps from that space onto the actual button numbers generated by the
# driver.
#                           _________       _____    _____
#                          /         \     |     |  |     |
#            _______      /           \    |     |  | (12)|
#           |  (10) |    /   mouse     \   | (3) |  |right|
#           |  [+]  |    \   pointer   /   | [e] |  |click|
#           |_______|     \           /    |     |  |     |
#           |  (11) |      \_________/     |     |  |     |
#           |  [-]  |                      |_____|  |_____|
#           |_______|
#
#
#     ________                    ________
#    /        |                  |   (9)  \
#   |         |        (4)       |  left   |
#   |        _|        ___       |_ click  |
#   |  (1)  |         /   \        |       |
#   | scroll|    (6) | (2) | (7)   |_______|
#   |       |        | [s] |       |       |
#   |       |_        \___/       _|  (8)  |
#   |         |                  |  middle |
#   |         |        (5)       |  click  |
#    \________|                  |________/
#
# It would be nice to also be able to map the wheel rotation and side clicks to
# keystrokes, but the driver generates the same button events for those actions
# as for scrolling with the ball.
#
# TODO: Maybe we can still use the side clicks on the wheel to do j/k or +/-?
# Or use the L thumb button as a modifier to change the behavior of other
# buttons?

# Tell Xorg that we are going to talk about input devices.
Section "InputClass"
  # A unique name for this device.
  Identifier "Elecom Trackball"

  # Only apply these settings to pointing devices that claim to be Logitech
  # Trackballs.
  MatchProduct "ELECOM TrackBall Mouse HUGE"
  MatchIsPointer "on"

  # Use libinput.
  MatchDevicePath "/dev/input/event*"
  Driver "libinput"

  # I don't know what this does. I cargo-culted it from someone else.
  Option "SendCoreEvents" "true"

  # In some cases I have the driver send high-order button presses (button20+),
  # which I then remap onto keystrokes in my i3 config.
  #
  #    "L" thumb button            ->                (used below for scroll)
  #    clicking the wheel          -> button20
  #    "R" finger button           -> button21
  #    spin wheel away from you    ->
  #    spin wheel away towards you ->
  #    push wheel down             ->
  #    push wheel up               ->
  #    right arrow thumb button    -> middle click
  #    left arrow thumb button     -> left click
  #    "Fn1" button                -> button22
  #    "Fn2" button                -> button23
  #    "Fn3" button                -> right click
  #
  Option "ButtonMapping" "0 20 21 0 0 0 0 2 1 0 0 3"

  # Enable scrolling mode by pressing the right arrow thumb button.
  Option "ScrollMethod" "button"
  Option "ScrollButton" "1"

  # I like low sensitivity (for fine adjustments) with high acceleration (for
  # fast movements).
  Option "AccelSpeed" "1"
EndSection

