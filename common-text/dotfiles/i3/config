# i3 config file (v4)
# Please see http://i3wm.org/docs/userguide.html for a complete reference!

# Alt
set $mod Mod1

##############################################################################
# APPEARANCE

font pango:DejaVu Sans Mono 12

# Make sure floating windows fit comfortably in the center of the screen.
floating_maximum_size 900 x 700

# Colors.
# class                 border  backgr. text    indicator
client.focused          #4c78FF #2855CC #ffffff #2e9ef4
client.focused_inactive #333333 #5f676a #ffffff #484e50
client.unfocused        #333333 #222222 #999999 #292d2e
client.urgent           #FF8855 #DD5500 #ffffff #DD5500

# Set border widths, and disable title bars for Chrome.
set $border 3
for_window [class="Google-chrome"] border pixel $border
new_window normal $border

# Some of my scripts explicitly set the title "floating_enable" to force their
# windows to float.
for_window [title="floating_enable"] floating enable

# Edge borders are frustrating for applications that put tabs across the top
# (like Chrome). By hiding them, we do miss out on the cues which i3 gives
# for the position of the next window to be opened, but it's a necessary
# loss.
hide_edge_borders both

##############################################################################
# BAR

bar {
  # Override fish's last-pwd remembrance; i3blocks needs to always run in
  # $HOME. We "exec" i3blocks so that signals are handled correctly; otherwise
  # fish exits prematurely when i3 tries to coordinate with it (such as when
  # the screen is locked).
  status_command exec fish -c 'cd ~ && exec i3blocks'
  position bottom

  # Once upon a time, we put "tray_output primary" here, but we suspected it of
  # causing the system tray to not show on initial startup. See
  # https://faq.i3wm.org/question/3258/i3bar-system-trayicon-disappeared/

  workspace_buttons yes
  binding_mode_indicator yes

  colors {
    background         #000000
    focused_background #000022

    statusline         #ffffff
    separator          #666666

    #                   border   backgr   text
    focused_workspace  #4c78FF  #2855CC  #ffffff
    active_workspace   #BBBBBB  #5f676a  #ffffff
    inactive_workspace #333333  #222222  #999999
    urgent_workspace   #FF8855  #DD5500  #ffffff
    binding_mode       #000000  #ffff00  #000000
  }
}

##############################################################################
# BEHAVIORS

# Use Alt+Left-Drag to move floating windows.
# Use Alt+Right-Drag to resize floating windows.
floating_modifier $mod

# Allow popup windows to interrupt fullscreen sessions.
popup_during_fullscreen leave_fullscreen

# Having focus follow the mouse is annoying on desktops (where the mouse
# clutters the desk), and it's hard to have it enabled on some of my
# machines and disabled on others. But I keep it on for every machine,
# because it's SO convenient. It helps to use a trackball mouse.
focus_follows_mouse on

# Focusing the current workspace will switch back and forth between it and
# the most recent unfocused workspace.
workspace_auto_back_and_forth yes

##############################################################################
# FOCUS

# Cycle through windows of the current workspace.
bindsym $mod+w focus next

# Cycle through workspaces on the current output.
bindsym $mod+Tab workspace next_on_output

# Jump to a fresh workspace.
bindsym $mod+Escape exec fish -c 'cd ~ && sbpgo_main i3_gateway switch_new'

# Jump to a specified workspace.
bindsym $mod+1 workspace number 1
bindsym $mod+2 workspace number 2
bindsym $mod+3 workspace number 3
bindsym $mod+4 workspace number 4
bindsym $mod+5 workspace number 5
bindsym $mod+6 workspace number 6
bindsym $mod+7 workspace number 7
bindsym $mod+8 workspace number 8
bindsym $mod+9 workspace number 9
bindsym $mod+0 workspace number 10

##############################################################################
# MOVING WORKSPACES

# Cycle the current workspace among outputs.
bindsym $mod+Up exec fish -c 'cd ~ && sbpgo_main i3_gateway output_left'
bindsym $mod+Down exec fish -c 'cd ~ && sbpgo_main i3_gateway output_right'

# Cycle the current workspace through the Z-order of the current output.
bindsym $mod+Left exec fish -c 'cd ~ && sbpgo_main i3_gateway swap_left'
bindsym $mod+Right exec fish -c 'cd ~ && sbpgo_main i3_gateway swap_right'

# Rename workspaces.
bindsym $mod+n exec fish -c 'cd ~ && sbpgo_main i3_gateway rename'

##############################################################################
# MOVING WINDOWS

# Move window to a fresh workspace.
bindsym $mod+Shift+Escape exec fish -c 'cd ~ && sbpgo_main i3_gateway move_new'

# Move window to a specified workspace.
bindsym $mod+Shift+exclam move container to workspace number 1; workspace number 1
bindsym $mod+Shift+at move container to workspace number 2; workspace number 2
bindsym $mod+Shift+numbersign move container to workspace number 3; workspace number 3
bindsym $mod+Shift+dollar move container to workspace number 4; workspace number 4
bindsym $mod+Shift+percent move container to workspace number 5; workspace number 5
bindsym $mod+Shift+asciicircum move container to workspace number 6; workspace number 6
bindsym $mod+Shift+ampersand move container to workspace number 7; workspace number 7
bindsym $mod+Shift+asterisk move container to workspace number 8; workspace number 8
bindsym $mod+Shift+parenleft move container to workspace number 9; workspace number 9
bindsym $mod+Shift+parenright move container to workspace number 10; workspace number 10

# Move window within a workspace.
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right



##############################################################################
# TODO: re-sort things below this line

# Restart i3 in-place, preserving the layout and running applications.
bindsym $mod+Shift+X restart

# Kill focused window.
bindsym $mod+q kill

##############################################################################
# LAYOUT MANAGEMENT

# Add horizontal or vertical splits to the current window.
bindsym $mod+h split horizontal
bindsym $mod+v split vertical

# Enter fullscreen mode for the focused container.
bindsym $mod+f fullscreen

# Change container layout (stacked, tabbed, default).
# TODO: bindsym $mod+w layout tabbed
bindsym $mod+e layout toggle split


##############################################################################
# WORKSPACE MANAGEMENT




##############################################################################
# RESIZE MODE

set $resizeAmount 10 px or 5 ppt

# Resize window (you can also use the mouse for that).
mode "resize" {
  # Keep the same bindings as before for focusing and moving windows
  # and workspaces. For these bindings, we allow them with or without the
  # Alt key.

  # Change focused window.
  bindsym Left focus left
  bindsym Down focus down
  bindsym Up focus up
  bindsym Right focus right

  bindsym $mod+Left focus left
  bindsym $mod+Down focus down
  bindsym $mod+Up focus up
  bindsym $mod+Right focus right

  # Move focused window.
  bindsym Shift+Left move left
  bindsym Shift+Down move down
  bindsym Shift+Up move up
  bindsym Shift+Right move right

  bindsym $mod+Shift+Left move left
  bindsym $mod+Shift+Down move down
  bindsym $mod+Shift+Up move up
  bindsym $mod+Shift+Right move right

  # Switch focus among the different monitors.
  bindsym j focus output left
  bindsym k focus output down
  bindsym l focus output up
  bindsym semicolon focus output right

  bindsym $mod+j focus output left
  bindsym $mod+k focus output down
  bindsym $mod+l focus output up
  bindsym $mod+semicolon focus output right

  # Move workspaces between monitors.
  bindsym Shift+J move workspace to output left
  bindsym Shift+K move workspace to output down
  bindsym Shift+L move workspace to output up
  bindsym Shift+colon move workspace to output right

  bindsym $mod+Shift+J move workspace to output left
  bindsym $mod+Shift+K move workspace to output down
  bindsym $mod+Shift+L move workspace to output up
  bindsym $mod+Shift+colon move workspace to output right

  # Use WASD to make the window bigger. Use Shift+WASD or Alt+WASD
  # to make the window smaller. For convenience, the Shift and Alt
  # modifiers cancel, so Alt+Shift+WASD is the same as WASD.

  bindsym w resize grow up $resizeAmount
  bindsym a resize grow left $resizeAmount
  bindsym s resize grow down $resizeAmount
  bindsym d resize grow right $resizeAmount

  bindsym Shift+W resize shrink up $resizeAmount
  bindsym Shift+A resize shrink left $resizeAmount
  bindsym Shift+S resize shrink down $resizeAmount
  bindsym Shift+D resize shrink right $resizeAmount

  bindsym $mod+w resize shrink up $resizeAmount
  bindsym $mod+a resize shrink left $resizeAmount
  bindsym $mod+s resize shrink down $resizeAmount
  bindsym $mod+d resize shrink right $resizeAmount

  bindsym $mod+Shift+W resize grow up $resizeAmount
  bindsym $mod+Shift+A resize grow left $resizeAmount
  bindsym $mod+Shift+S resize grow down $resizeAmount
  bindsym $mod+Shift+D resize grow right $resizeAmount

  # back to normal: Enter or Escape (with optional Alt)
  bindsym Return mode "default"
  bindsym Escape mode "default"
  bindsym $mod+Return mode "default"
  bindsym $mod+Escape mode "default"
}

bindsym $mod+r mode "resize"


##############################################################################
# PROGRAM SHORTCUTS

# Start a default shell. Don't proxy through fish, since fish will run inside
# the terminator.
bindsym $mod+Return exec terminator

# Start a simplified shell (dash) in case the default shell (fish) is broken.
# Skip fish so that this works reliably even if everything else is broken.
bindsym $mod+Shift+Return exec terminator -e dash

# Start a Python shell.
bindsym $mod+y exec fish -c 'cd ~ && terminator -e python'

# Start dmenu (a program launcher).
bindsym $mod+space exec fish -c 'cd ~ && sbp-dmenu-run'

# Start a text editor.
bindsym $mod+BackSpace exec fish -c 'cd ~ && pluma'

# Start browsers.
bindsym $mod+c exec fish -c 'cd ~ && google-chrome'
bindsym $mod+Shift+C exec fish -c 'cd ~ && google-chrome --incognito'

# Screen locking.
bindsym Scroll_Lock exec fish -c 'cd ~ && sbplock'
# For a Lenovo X1 Carbon, use the Gear key (same key as F9).
bindsym XF86Tools exec fish -c 'cd ~ && sbplock'
# Also map XF86PowerOff, which sometimes gets sent by the Kinesis keyboard if
# you push the ScrollLock button :/
bindsym XF86PowerOff exec fish -c 'cd ~ && sbplock'

# Shutdown/restart dialog.
bindsym $mod+Delete exec fish -c 'cd ~ && shutdown-dialog'

# Print screen.
bindsym Print exec fish -c 'cd ~ && spectacle --current'

# Set i3 workspace alarm.
bindsym $mod+m exec fish -c 'cd ~ && set-alarm'

# Pause/unpause mocp music.
bindsym $mod+u exec fish -c 'cd ~ && mocp --toggle-pause'


##############################################################################
# AUTORUNS

exec --no-startup-id fish -c 'cd ~ && ./.autorun.sh'
